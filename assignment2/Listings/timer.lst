C166 COMPILER V7.57.0, TIMER                                                               10/05/2022 20:32:28 PAGE 1   


C166 COMPILER V7.57.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: D:\Keil\C166\BIN\C166.EXE Drivers\timer.c BROWSE MOD167 DEBUG PRINT(.\Listings\timer.lst) TABS(2) O
                    -BJECT(.\Objects\timer.obj) 

 stmt lvl     source

    1         // a1793769 - Emily Zhang
    2         /**
    3         Function implementation for operations related to the C167 timers
    4         **/
    5         
    6         #include <reg167.h>
    7         #include "timer.h"
    8         
    9         /********** Function Declearations **********/
   10         
   11         void timerT6Config(unsigned int prescaler, unsigned int mode, unsigned int direction)
   12         {
   13  1        // want to use prescaler == 4
   14  1        T6CON |= (prescaler << TIMER_IN_S_BIT);
   15  1      
   16  1        // want to use regular timer mode
   17  1        T6CON |= (mode << TIMER_MODE_BIT);
   18  1      
   19  1        // want to count down
   20  1        T6CON |= (direction << COUNT_DIR_BIT);
   21  1        
   22  1      }
   23         
   24         void timerT6StartMS(unsigned int ms)
   25         {
   26  1        unsigned int T6I = 0;
   27  1        unsigned int value = 0;
   28  1        float percentage = 0;
   29  1        float period = 0;
   30  1      
   31  1        // get period based on input selection (T6CON[2:0])
   32  1        T6I = (T6CON & 0x07);
   33  1      
   34  1        switch (T6I) {
   35  2          case 000:
   36  2            period = 13.0;
   37  2            break;
   38  2        }
   39  1      
   40  1        // calculate usage percentage
   41  1        percentage = ms / period;
   42  1      
   43  1        // calculate inital value
   44  1        value = percentage * 0xFFFF;
   45  1      
   46  1        // load inital value
   47  1        T6 = value;
   48  1      
   49  1        T6CON |= (TIMER_ON << TIMER_START_BIT);
   50  1      }


MODULE INFORMATION:   INITIALIZED  UNINITIALIZED
  CODE SIZE        =         108     --------
C166 COMPILER V7.57.0, TIMER                                                               10/05/2022 20:32:28 PAGE 2   

  NEAR-CONST SIZE  =    --------     --------
  FAR-CONST SIZE   =    --------     --------
  HUGE-CONST SIZE  =    --------     --------
  XHUGE-CONST SIZE =    --------     --------
  NEAR-DATA SIZE   =    --------     --------
  FAR-DATA SIZE    =    --------     --------
  XHUGE-DATA SIZE  =    --------     --------
  IDATA-DATA SIZE  =    --------     --------
  SDATA-DATA SIZE  =    --------     --------
  BDATA-DATA SIZE  =    --------     --------
  HUGE-DATA SIZE   =    --------     --------
  BIT SIZE         =    --------     --------
  INIT'L SIZE      =    --------     --------
END OF MODULE INFORMATION.


C166 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
