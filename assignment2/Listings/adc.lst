C166 COMPILER V7.57.0, ADC                                                                 10/05/2022 20:35:47 PAGE 1   


C166 COMPILER V7.57.0, COMPILATION OF MODULE ADC
OBJECT MODULE PLACED IN .\Objects\adc.obj
COMPILER INVOKED BY: D:\Keil\C166\BIN\C166.EXE Drivers\adc.c BROWSE MOD167 DEBUG PRINT(.\Listings\adc.lst) TABS(2) OBJEC
                    -T(.\Objects\adc.obj) 

 stmt lvl     source

    1         // a1793769 - Emily Zhang
    2         /**
    3         Function implementations for operations related to the C167 ADC
    4         **/
    5         
    6         #include "Drivers/adc.h"
    7         
    8         void adcGpioInit(void)
    9         {
   10  1        configPinP5(ENCODER_PIN, ANALOGUE);
   11  1        configPinP5(LIDAR_PIN, ANALOGUE);
   12  1      }
   13         
   14         void adcReset(void)
   15         {
   16  1        // TBD
   17  1        ADCON = 0x0000;
   18  1      }
   19         
   20         unsigned int adcCheckBusy(void)
   21         {
   22  1        if (ADCON & (1 << BUSY_BIT))
   23  1        {
   24  2          return 1;
   25  2        }
   26  1        else
   27  1        {
   28  2          return 0;
   29  2        } 
   30  1      }
   31         
   32         float adcRead(unsigned int channel, unsigned int mode)
   33         {
   34  1        float result;
   35  1        
   36  1        // set conversion channel
   37  1        ADCON |= (channel << CH_BIT);
   38  1      
   39  1        // set conversion mode
   40  1        ADCON |= (mode << MODE_BIT);
   41  1      
   42  1        // start conversion 
   43  1        ADCON |= (ADC_ON << START_BIT);
   44  1      
   45  1        // wait
   46  1        while (adcCheckBusy()){}
   47  1      
   48  1        // once no longer busy, grab result
   49  1        result = (ADDAT &= 0x3FF);
   50  1      
   51  1        adcReset();
   52  1      
   53  1        return result;
   54  1      }
C166 COMPILER V7.57.0, ADC                                                                 10/05/2022 20:35:47 PAGE 2   



MODULE INFORMATION:   INITIALIZED  UNINITIALIZED
  CODE SIZE        =          86     --------
  NEAR-CONST SIZE  =    --------     --------
  FAR-CONST SIZE   =    --------     --------
  HUGE-CONST SIZE  =    --------     --------
  XHUGE-CONST SIZE =    --------     --------
  NEAR-DATA SIZE   =    --------     --------
  FAR-DATA SIZE    =    --------     --------
  XHUGE-DATA SIZE  =    --------     --------
  IDATA-DATA SIZE  =    --------     --------
  SDATA-DATA SIZE  =    --------     --------
  BDATA-DATA SIZE  =    --------     --------
  HUGE-DATA SIZE   =    --------     --------
  BIT SIZE         =    --------     --------
  INIT'L SIZE      =    --------     --------
END OF MODULE INFORMATION.


C166 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
